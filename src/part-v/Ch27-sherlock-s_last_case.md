# 福尔摩斯的最后一案

![福尔摩斯](../images/sherlock.png)

“我们有的，只是该程序的一个片段，” Armstrong 说，“但我们对他来自哪里，关于什么毫无头绪。”

“给我看看，” Holmes 说。

“是这样的，” Armstrong 说，然后他向 Holmes 倾身，给他看了一张有些奇怪符号、括号和箭头，其间夹杂着一些英文文本的小纸条。


“那是什么？” Armstrong 问道。“Lestrade 说这是某种强大的黑魔法，来自未来。”

“这是计算机程序的一部分，” Holmes 抽着烟斗说道。“作为我时间旅行实验的一部分，我设法地传送了来自未来的一台计算机，及一大堆文件。在这些文件中，我发现了 Erlang 邮件列表中的 73,445 封邮件。我认为，通过将你那纸片上的文本，与这些邮件进行比对，我们将能发现这些奇怪符号的意义。但是怎么做呢？我拿出了我的斯特拉迪瓦里琴，演奏了一首帕格尼尼的曲子。然后我就想到了。邮件列表中与你纸条上文本最相似的帖子，必定是与文档中单词的 TF*IDF 分数余弦值相似度最大的......”


“这太棒了，” Armstrong 说，“但是 TF*IFD 分数是什么呢？”

“这是基本知识，亲爱的 Armstrong，” Holmes 说。 “这是项的频率，乘以逆文档频率。我要解释一下......”

## 找出数据相似性

在写作本文时，Erlang 邮件列表中有 73,445 封邮件。<sup>1</sup> 这表示大量可通过多种方式重用的知识。我们可用其回答有关 Erlang 的问题，或寻求灵感。

> *译注*：<sup>1</sup> `erlang-questions` 邮件列表已于 2022 年 4 月关闭。
>
> 参考：
>
> - [The erlang-questions Archives](http://erlang.org/pipermail/erlang-questions/)
>
> - [erlang-questions -- General Erlang/OTP discussions](http://erlang.org/mailman/listinfo/erlang-questions)


设想咱们正编写某个程序并需要帮助。这就是 Sherlock 发挥作用的地方。Sherlock 会分析咱们的程序，然后给出 Erlang 邮件列表中，所有可能会对咱们有所帮助的先前邮件里，最相似的帖子。


那么下面就是总体规划。

- 第 1 步是下载整个 Erlang 邮件列表，并将其存储在本地；
- 第 2 步是组织和解析所有邮件；
- 第 3 步是计算可用于相似性检索的邮件某些属性；
- 第 4 步是查询这些邮件，找出与咱们程序最相似的邮件。


这是这一章的核心思想。其中有很多变种。我们可下载所有曾编写过的 Erlang 模组，并检索他们的相似之处；或者我们可取得大量推文，或咱们感兴趣的任何大型数据集。


还有一种可用于帮助咱们对数据分类的变种。设想咱们刚写下一条简短笔记，并打算将其存储在某个文件中。确定文件名或存储文件的目录，是个难题。或许这与磁盘上的某个我（作者）几年前编写的某个别的文件非常相似，又或者其与我甚至不知道的其他某人编写的某个别的文档类似。在这两种情况下，我（作者）都希望从一个极大文档集中，找到与我的新文档最相似的文档。


当我们不知道相似之处为何时，Sherlock 会找出事物间的相似之处。我们会用他找出与 Erlang 邮件列表中那些贡献的相似之处。


在我们开始讨论实施细节前，我们将于实际操作中，展示 Sherlock 这个程序。



## 与 Sherlock 的一次对话



